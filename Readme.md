ðŸ§¬ Prediction of Regulatory Motifs from Human ChIP-Sequencing Data Using a Deep Learning Framework
Overview

This project applies a convolutional neural network (CNN) to predict transcription factor binding sites (TFBSs) from raw DNA sequences derived from human ChIP-sequencing (ChIP-seq) data. Using experimentally validated binding regions from the ENCODE project, the model learns sequence patterns associated with transcription factor binding and identifies cis-regulatory motifs directly from genomic sequence data.

The project demonstrates that deep learning models can accurately capture regulatory sequence features without manual motif engineering and can provide biologically interpretable results through motif visualization.

# Biological Problem Understanding
Transcription Factors (TF) are proteins that bind to the regulatory regions of the DNA, such as promoters, and either promote or repress gene expression. TFs regulate gene expression by binding to specific DNA regions. These binding events control when and where genes are activated or repressed and are essential for maintaining normal cellular function.
Each TF has a specific binding motif (i.e., pattern or sequence of bases) in the DNA that it binds to, referred to as a transcription-factor binding site (TFBS). These binding sites are crucial because they control various processes in the body. 

ChIP-seq experiments generate genome-wide maps of TFâ€“DNA interactions, but identifying the underlying sequence determinants of TF binding remains challenging due to:
High dimensionality of genomic sequences
Sequence heterogeneity and noise
Degenerate or weakly conserved binding motifs

Traditional motif discovery approaches (e.g. PWMs) often fail to fully capture these complexities. CNNs offer a data-driven alternative that can learn motif-like patterns directly from DNA sequences.

# Project Objectives
Our goal is to build a predictive model. The model aims to predict whether a particular sequence of bases will bind to the transcription factor.
* Build a CNN model to classify genomic regions as TF binding or non-binding.

* Train the model using real human ChIP-seq data from ENCODE.

* Evaluate model generalization on held-out test data.

* Interpret learned sequence features by extracting and visualizing CNN motifs.

## Transcription Factor of Interest

* Transcription Factor: CTCF

* Cell Line: GM12878 (human lymphoblastoid cell line)

* Assay: ChIP-seq

CTCF is a well-studied architectural protein involved in chromatin looping, insulation, and long-range gene regulation, making it an ideal benchmark TF for motif-learning approaches.

# Dataset Description
Data Source

ENCODE Project (March 2012 data freeze)

UCSC Genome Browser ENCODE downloads
[Data](https://genome.ucsc.edu/ENCODE/downloads.html)

### Files Used

Positive regions (binding sites):
wgEncodeAwgTfbsBroadGm12878CtcfUniPk.narrowPeak.gz

Genome assembly:

Human reference genome: hg19

Chromosome sizes file: hg19.genome

### Data Preparation
Positive Samples: ChIP-seq peak regions corresponding to CTCF binding sites in GM12878 cells. Peak coordinates extracted from ENCODE narrowPeak files.
Negative Samples:Generated by randomly shuffling genomic regions across the hg19 genome using bedtools shuffle to Ensure realistic genomic background.

### Sequence Extraction
DNA sequences extracted from hg19 using bedtools getfasta.Fixed sequence length used for all samples.

notebook CTCF_BS_CNN.ipynb
Positive and negative FASTA files merged into a single CSV file with labels.

### Inputation
Each DNA sequence is encoded using one-hot encoding:

#### Base	Encoding
#### A	[1, 0, 0, 0]
#### C	[0, 1, 0, 0]
#### G	[0, 0, 1, 0]
#### T	[0, 0, 0, 1]

Final input tensor shape:(number_of_sequences, sequence_length, 4)

### Model Architecture

The CNN architecture is designed to detect motif-like patterns:

1D convolutional layer (motif detectors) -> ReLU activation -> Max-pooling -> Fully connected layers -> Sigmoid output for binary classification


### Training Strategy

Dataset split into:
Training set (80)%, Validation set(10%), Test set(10)%
Stratified splitting to preserve class balance

Binary classification, cross-entropy loss, Adam optimizer

# Model Performance (Test Set)
Metric	Value
Accuracy	90.5%
ROCâ€“AUC	0.966
Classification Report:
                       precision    recall  f1-score   support

Non-CTCF binding site       0.89      0.93      0.91      5623
    CTCF binding site       0.93      0.88      0.90      5623

             accuracy                           0.91     11246
            macro avg       0.91      0.91      0.91     11246
         weighted avg       0.91      0.91      0.91     11246

ROC-AUC: 0.9661756867397182

Remarks: The high ROCâ€“AUC indicates strong discriminative ability between binding and non-binding genomic regions.

# Motif Interpretation

To interpret the learned features:

Convolutional filters from the first CNN layer were extracted. Filters were converted into position weight matrices. Sequence logos were generated to visualize learned motifs.
Remarks: The extracted motifs capture sequence patterns consistent with known transcription factor binding behavior, confirming that the model learned biologically meaningful features rather than noise.

# Tools and Technologies

* Python
* TensorFlow / Keras
* scikit-learn
* bedtools
* UCSC hg19 reference genome
* logomaker (for motif visualization)

# Significance

This project demonstrates that deep learning CNNs :
* Can accurately predict TF binding from sequence alone.
* Learns biologically meaningful motifs directly from DNA
* Outperforms traditional motif discovery methods in complex settings
* Provides interpretable models for regulatory genomics
* The approach is scalable to large datasets and applicable to a wide range of transcription factors and cell types.

# Future Extensions
* Activation-based motif discovery (DeepBind-style)
* Comparison with known CTCF motifs from JASPAR
* Multi-TF or multi-task learning
* Integration of chromatin accessibility (ATAC-seq)

References
Jinyu Yang, Anjun Ma, Adam D Hoppe, Cankun Wang, Yang Li, Chi Zhang, Yan Wang, Bingqiang Liu, Qin Ma, Prediction of regulatory motifs from human Chip-sequencing data using a deep learning framework, Nucleic Acids Research, Volume 47, Issue 15, 05 September 2019, Pages 7809â€“7824, https://doi.org/10.1093/nar/gkz672
